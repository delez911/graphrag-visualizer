{
    "sourceFile": "src/app/components/APISearchDrawer.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 21,
            "patches": [
                {
                    "date": 1727243774068,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1727243789771,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -50,8 +50,9 @@\n   globalSearchEnabled,\n   hasCovariates,\n   serverUp,\n }) => {\n+  const { t } = useTranslation();\n   const [query, setQuery] = useState<string>(\"\");\n   const [loadingLocal, setLoadingLocal] = useState<boolean>(false);\n   const [loadingGlobal, setLoadingGlobal] = useState<boolean>(false);\n   const [expandedTables, setExpandedTables] = useState<{\n"
                },
                {
                    "date": 1727243878776,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -50,9 +50,9 @@\n   globalSearchEnabled,\n   hasCovariates,\n   serverUp,\n }) => {\n-  const { t } = useTranslation();\n+  const { t } = useTranslation('graphViewer');\n   const [query, setQuery] = useState<string>(\"\");\n   const [loadingLocal, setLoadingLocal] = useState<boolean>(false);\n   const [loadingGlobal, setLoadingGlobal] = useState<boolean>(false);\n   const [expandedTables, setExpandedTables] = useState<{\n"
                },
                {
                    "date": 1727243950927,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -117,14 +117,9 @@\n         <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 2 }}>\n           <TextField\n             value={query}\n             onChange={(e) => setQuery(e.target.value)}\n-            // onKeyDown={async (e) => {\n-            //   if (e.key === \"Enter\" && !loadingLocal) {\n-            //     await handleSearch(\"local\"); // Default to global search on enter\n-            //   }\n-            // }}\n-            placeholder=\"Enter search query for API\"\n+            placeholder={t('apiSearchDrawer.placeholder')}\n             fullWidth\n             margin=\"normal\"\n           />\n \n@@ -140,9 +135,9 @@\n                 loadingLocal ||\n                 loadingGlobal\n               }\n             >\n-              {loadingLocal ? <CircularProgress size={24} /> : \"Local Search\"}\n+              {loadingLocal ? <CircularProgress size={24} /> : t('apiSearchDrawer.localSearch')}\n             </Button>\n             <Button\n               variant=\"contained\"\n               color=\"success\"\n@@ -154,45 +149,42 @@\n                 loadingLocal ||\n                 loadingGlobal\n               }\n             >\n-              {loadingGlobal ? <CircularProgress size={24} /> : \"Global Search\"}\n+              {loadingGlobal ? <CircularProgress size={24} /> : t('apiSearchDrawer.globalSearch')}\n             </Button>\n           </Box>\n \n           {!serverUp && (\n             <Alert severity=\"error\" sx={{ mt: 1 }}>\n-              Server is not running. Please start the server to use the API.\n-              Follow the instructions at{\" \"}\n+              {t('apiSearchDrawer.serverNotRunning')}{\" \"}\n               <Link\n                 href=\"https://github.com/noworneverev/graphrag-api\"\n                 target=\"_blank\"\n                 rel=\"noopener noreferrer\"\n               >\n-                graphrag-api\n+                {t('apiSearchDrawer.graphragApi')}\n               </Link>\n               .\n             </Alert>\n           )}\n           {!localSearchEnabled && (\n             <Alert severity=\"warning\" sx={{ mt: 1 }}>\n-              Please enable \"Include Text Unit\" and \"Include Communities\"\n-              {hasCovariates && ', and \"Include Covariates\"'} to use Local\n-              Search.\n+              {t('apiSearchDrawer.enableLocalSearch', { hasCovariates })}\n             </Alert>\n           )}\n           {!globalSearchEnabled && (\n             <Alert severity=\"warning\" sx={{ mt: 1 }}>\n-              Please enable \"Include Communities\" to use Global Search.\n+              {t('apiSearchDrawer.enableGlobalSearch')}\n             </Alert>\n           )}\n         </Box>\n \n         {apiSearchResults && (\n           <>\n             {/* Search Results Card */}\n             <Card sx={{ marginTop: 2 }}>\n-              <CardHeader title=\"Search Results\" />\n+              <CardHeader title={t('apiSearchDrawer.searchResults')} />\n               <CardContent>\n                 <Typography variant=\"body1\" sx={{ whiteSpace: \"pre-wrap\" }}>\n                   {apiSearchResults.response}\n                 </Typography>\n@@ -200,19 +192,19 @@\n             </Card>\n \n             {/* Metadata Card */}\n             <Card sx={{ marginTop: 2 }}>\n-              <CardHeader title=\"Metadata\" />\n+              <CardHeader title={t('apiSearchDrawer.metadata')} />\n               <CardContent>\n                 <Typography variant=\"body2\">\n-                  <strong>Completion Time:</strong>{\" \"}\n+                  <strong>{t('apiSearchDrawer.completionTime')}</strong>{\" \"}\n                   {apiSearchResults.completion_time} ms\n                 </Typography>\n                 <Typography variant=\"body2\">\n-                  <strong>LLM Calls:</strong> {apiSearchResults.llm_calls}\n+                  <strong>{t('apiSearchDrawer.llmCalls')}</strong> {apiSearchResults.llm_calls}\n                 </Typography>\n                 <Typography variant=\"body2\">\n-                  <strong>Prompt Tokens:</strong>{\" \"}\n+                  <strong>{t('apiSearchDrawer.promptTokens')}</strong>{\" \"}\n                   {apiSearchResults.prompt_tokens}\n                 </Typography>\n               </CardContent>\n             </Card>\n@@ -274,9 +266,9 @@\n                             </Table>\n                           </TableContainer>\n                         ) : (\n                           <Typography variant=\"body2\" color=\"textSecondary\">\n-                            No data available\n+                            {t('apiSearchDrawer.noDataAvailable')}\n                           </Typography>\n                         )}\n                       </CardContent>\n                     </Collapse>\n"
                },
                {
                    "date": 1727244019495,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -117,8 +117,13 @@\n         <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 2 }}>\n           <TextField\n             value={query}\n             onChange={(e) => setQuery(e.target.value)}\n+             // onKeyDown={async (e) => {\n+            //   if (e.key === \"Enter\" && !loadingLocal) {\n+            //     await handleSearch(\"local\"); // Default to global search on enter\n+            //   }\n+            // }}\n             placeholder={t('apiSearchDrawer.placeholder')}\n             fullWidth\n             margin=\"normal\"\n           />\n"
                },
                {
                    "date": 1727244031005,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -117,14 +117,14 @@\n         <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 2 }}>\n           <TextField\n             value={query}\n             onChange={(e) => setQuery(e.target.value)}\n-             // onKeyDown={async (e) => {\n+            // onKeyDown={async (e) => {\n             //   if (e.key === \"Enter\" && !loadingLocal) {\n             //     await handleSearch(\"local\"); // Default to global search on enter\n             //   }\n             // }}\n-            placeholder={t('apiSearchDrawer.placeholder')}\n+            placeholder=\"Enter search query for API\"\n             fullWidth\n             margin=\"normal\"\n           />\n \n@@ -140,9 +140,9 @@\n                 loadingLocal ||\n                 loadingGlobal\n               }\n             >\n-              {loadingLocal ? <CircularProgress size={24} /> : t('apiSearchDrawer.localSearch')}\n+              {loadingLocal ? <CircularProgress size={24} /> : \"Local Search\"}\n             </Button>\n             <Button\n               variant=\"contained\"\n               color=\"success\"\n@@ -154,42 +154,45 @@\n                 loadingLocal ||\n                 loadingGlobal\n               }\n             >\n-              {loadingGlobal ? <CircularProgress size={24} /> : t('apiSearchDrawer.globalSearch')}\n+              {loadingGlobal ? <CircularProgress size={24} /> : \"Global Search\"}\n             </Button>\n           </Box>\n \n           {!serverUp && (\n             <Alert severity=\"error\" sx={{ mt: 1 }}>\n-              {t('apiSearchDrawer.serverNotRunning')}{\" \"}\n+              Server is not running. Please start the server to use the API.\n+              Follow the instructions at{\" \"}\n               <Link\n                 href=\"https://github.com/noworneverev/graphrag-api\"\n                 target=\"_blank\"\n                 rel=\"noopener noreferrer\"\n               >\n-                {t('apiSearchDrawer.graphragApi')}\n+                graphrag-api\n               </Link>\n               .\n             </Alert>\n           )}\n           {!localSearchEnabled && (\n             <Alert severity=\"warning\" sx={{ mt: 1 }}>\n-              {t('apiSearchDrawer.enableLocalSearch', { hasCovariates })}\n+              Please enable \"Include Text Unit\" and \"Include Communities\"\n+              {hasCovariates && ', and \"Include Covariates\"'} to use Local\n+              Search.\n             </Alert>\n           )}\n           {!globalSearchEnabled && (\n             <Alert severity=\"warning\" sx={{ mt: 1 }}>\n-              {t('apiSearchDrawer.enableGlobalSearch')}\n+              Please enable \"Include Communities\" to use Global Search.\n             </Alert>\n           )}\n         </Box>\n \n         {apiSearchResults && (\n           <>\n             {/* Search Results Card */}\n             <Card sx={{ marginTop: 2 }}>\n-              <CardHeader title={t('apiSearchDrawer.searchResults')} />\n+              <CardHeader title=\"Search Results\" />\n               <CardContent>\n                 <Typography variant=\"body1\" sx={{ whiteSpace: \"pre-wrap\" }}>\n                   {apiSearchResults.response}\n                 </Typography>\n@@ -197,19 +200,19 @@\n             </Card>\n \n             {/* Metadata Card */}\n             <Card sx={{ marginTop: 2 }}>\n-              <CardHeader title={t('apiSearchDrawer.metadata')} />\n+              <CardHeader title=\"Metadata\" />\n               <CardContent>\n                 <Typography variant=\"body2\">\n-                  <strong>{t('apiSearchDrawer.completionTime')}</strong>{\" \"}\n+                  <strong>Completion Time:</strong>{\" \"}\n                   {apiSearchResults.completion_time} ms\n                 </Typography>\n                 <Typography variant=\"body2\">\n-                  <strong>{t('apiSearchDrawer.llmCalls')}</strong> {apiSearchResults.llm_calls}\n+                  <strong>LLM Calls:</strong> {apiSearchResults.llm_calls}\n                 </Typography>\n                 <Typography variant=\"body2\">\n-                  <strong>{t('apiSearchDrawer.promptTokens')}</strong>{\" \"}\n+                  <strong>Prompt Tokens:</strong>{\" \"}\n                   {apiSearchResults.prompt_tokens}\n                 </Typography>\n               </CardContent>\n             </Card>\n@@ -271,9 +274,9 @@\n                             </Table>\n                           </TableContainer>\n                         ) : (\n                           <Typography variant=\"body2\" color=\"textSecondary\">\n-                            {t('apiSearchDrawer.noDataAvailable')}\n+                            No data available\n                           </Typography>\n                         )}\n                       </CardContent>\n                     </Collapse>\n"
                },
                {
                    "date": 1727244275347,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -122,9 +122,9 @@\n             //   if (e.key === \"Enter\" && !loadingLocal) {\n             //     await handleSearch(\"local\"); // Default to global search on enter\n             //   }\n             // }}\n-            placeholder=\"Enter search query for API\"\n+            placeholder={t('apiSearchDrawer.placeholder')}\n             fullWidth\n             margin=\"normal\"\n           />\n \n"
                },
                {
                    "date": 1727244290666,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -122,9 +122,9 @@\n             //   if (e.key === \"Enter\" && !loadingLocal) {\n             //     await handleSearch(\"local\"); // Default to global search on enter\n             //   }\n             // }}\n-            placeholder={t('apiSearchDrawer.placeholder')}\n+            placeholder=\"Enter search query for API\"\n             fullWidth\n             margin=\"normal\"\n           />\n \n"
                },
                {
                    "date": 1727244302076,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -122,9 +122,9 @@\n             //   if (e.key === \"Enter\" && !loadingLocal) {\n             //     await handleSearch(\"local\"); // Default to global search on enter\n             //   }\n             // }}\n-            placeholder=\"Enter search query for API\"\n+            placeholder=\"{t('apiSearchDrawer.placeholder')}\"\n             fullWidth\n             margin=\"normal\"\n           />\n \n"
                },
                {
                    "date": 1727244336712,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -122,9 +122,9 @@\n             //   if (e.key === \"Enter\" && !loadingLocal) {\n             //     await handleSearch(\"local\"); // Default to global search on enter\n             //   }\n             // }}\n-            placeholder=\"{t('apiSearchDrawer.placeholder')}\"\n+            placeholder=\"Enter search query for API\"\n             fullWidth\n             margin=\"normal\"\n           />\n \n@@ -140,9 +140,9 @@\n                 loadingLocal ||\n                 loadingGlobal\n               }\n             >\n-              {loadingLocal ? <CircularProgress size={24} /> : \"Local Search\"}\n+              {loadingLocal ? <CircularProgress size={24} /> : t('apiSearchDrawer.localSearch')}\n             </Button>\n             <Button\n               variant=\"contained\"\n               color=\"success\"\n"
                },
                {
                    "date": 1727244345041,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -122,9 +122,9 @@\n             //   if (e.key === \"Enter\" && !loadingLocal) {\n             //     await handleSearch(\"local\"); // Default to global search on enter\n             //   }\n             // }}\n-            placeholder=\"Enter search query for API\"\n+            placeholder=t('apiSearchDrawer.localSearch')\n             fullWidth\n             margin=\"normal\"\n           />\n \n"
                },
                {
                    "date": 1727244377649,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -122,9 +122,9 @@\n             //   if (e.key === \"Enter\" && !loadingLocal) {\n             //     await handleSearch(\"local\"); // Default to global search on enter\n             //   }\n             // }}\n-            placeholder=t('apiSearchDrawer.localSearch')\n+            placeholder=\"Enter search query for API\"\n             fullWidth\n             margin=\"normal\"\n           />\n \n@@ -154,9 +154,9 @@\n                 loadingLocal ||\n                 loadingGlobal\n               }\n             >\n-              {loadingGlobal ? <CircularProgress size={24} /> : \"Global Search\"}\n+              {loadingGlobal ? <CircularProgress size={24} /> : t('apiSearchDrawer.globalSearch')}}\n             </Button>\n           </Box>\n \n           {!serverUp && (\n"
                },
                {
                    "date": 1727244410179,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -154,16 +154,15 @@\n                 loadingLocal ||\n                 loadingGlobal\n               }\n             >\n-              {loadingGlobal ? <CircularProgress size={24} /> : t('apiSearchDrawer.globalSearch')}}\n+              {loadingGlobal ? <CircularProgress size={24} /> : t('apiSearchDrawer.globalSearch')}\n             </Button>\n           </Box>\n \n           {!serverUp && (\n             <Alert severity=\"error\" sx={{ mt: 1 }}>\n-              Server is not running. Please start the server to use the API.\n-              Follow the instructions at{\" \"}\n+              {t('apiSearchDrawer.serverNotRunning')}{\" \"}\n               <Link\n                 href=\"https://github.com/noworneverev/graphrag-api\"\n                 target=\"_blank\"\n                 rel=\"noopener noreferrer\"\n"
                },
                {
                    "date": 1727244425114,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -166,9 +166,9 @@\n                 href=\"https://github.com/noworneverev/graphrag-api\"\n                 target=\"_blank\"\n                 rel=\"noopener noreferrer\"\n               >\n-                graphrag-api\n+                {t('apiSearchDrawer.graphragApi')}\n               </Link>\n               .\n             </Alert>\n           )}\n"
                },
                {
                    "date": 1727244443935,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -173,11 +173,9 @@\n             </Alert>\n           )}\n           {!localSearchEnabled && (\n             <Alert severity=\"warning\" sx={{ mt: 1 }}>\n-              Please enable \"Include Text Unit\" and \"Include Communities\"\n-              {hasCovariates && ', and \"Include Covariates\"'} to use Local\n-              Search.\n+              {t('apiSearchDrawer.enableLocalSearch', { hasCovariates })}\n             </Alert>\n           )}\n           {!globalSearchEnabled && (\n             <Alert severity=\"warning\" sx={{ mt: 1 }}>\n"
                },
                {
                    "date": 1727244456075,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -178,9 +178,9 @@\n             </Alert>\n           )}\n           {!globalSearchEnabled && (\n             <Alert severity=\"warning\" sx={{ mt: 1 }}>\n-              Please enable \"Include Communities\" to use Global Search.\n+              {t('apiSearchDrawer.enableGlobalSearch')}\n             </Alert>\n           )}\n         </Box>\n \n"
                },
                {
                    "date": 1727244489401,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -200,9 +200,9 @@\n             <Card sx={{ marginTop: 2 }}>\n               <CardHeader title=\"Metadata\" />\n               <CardContent>\n                 <Typography variant=\"body2\">\n-                  <strong>Completion Time:</strong>{\" \"}\n+                  <strong>{t('apiSearchDrawer.completionTime')}</strong>{\" \"}\n                   {apiSearchResults.completion_time} ms\n                 </Typography>\n                 <Typography variant=\"body2\">\n                   <strong>LLM Calls:</strong> {apiSearchResults.llm_calls}\n"
                },
                {
                    "date": 1727244514072,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -204,9 +204,9 @@\n                   <strong>{t('apiSearchDrawer.completionTime')}</strong>{\" \"}\n                   {apiSearchResults.completion_time} ms\n                 </Typography>\n                 <Typography variant=\"body2\">\n-                  <strong>LLM Calls:</strong> {apiSearchResults.llm_calls}\n+                  <strong>{t('apiSearchDrawer.llmCalls')}:</strong> {apiSearchResults.llm_calls}\n                 </Typography>\n                 <Typography variant=\"body2\">\n                   <strong>Prompt Tokens:</strong>{\" \"}\n                   {apiSearchResults.prompt_tokens}\n"
                },
                {
                    "date": 1727249378176,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -122,9 +122,9 @@\n             //   if (e.key === \"Enter\" && !loadingLocal) {\n             //     await handleSearch(\"local\"); // Default to global search on enter\n             //   }\n             // }}\n-            placeholder=\"Enter search query for API\"\n+            placeholder=「\"Enter search query for API\"\n             fullWidth\n             margin=\"normal\"\n           />\n \n@@ -200,9 +200,9 @@\n             <Card sx={{ marginTop: 2 }}>\n               <CardHeader title=\"Metadata\" />\n               <CardContent>\n                 <Typography variant=\"body2\">\n-                  <strong>{t('apiSearchDrawer.completionTime')}</strong>{\" \"}\n+                  <strong>{t('apiSearchDrawer.completionTime')}:</strong>{\" \"}\n                   {apiSearchResults.completion_time} ms\n                 </Typography>\n                 <Typography variant=\"body2\">\n                   <strong>{t('apiSearchDrawer.llmCalls')}:</strong> {apiSearchResults.llm_calls}\n"
                },
                {
                    "date": 1727249649726,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -122,9 +122,9 @@\n             //   if (e.key === \"Enter\" && !loadingLocal) {\n             //     await handleSearch(\"local\"); // Default to global search on enter\n             //   }\n             // }}\n-            placeholder=「\"Enter search query for API\"\n+            placeholder={t('apiSearchDrawer.placeholder')\"Enter search query for API\"}\n             fullWidth\n             margin=\"normal\"\n           />\n \n"
                },
                {
                    "date": 1727249685526,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -122,9 +122,9 @@\n             //   if (e.key === \"Enter\" && !loadingLocal) {\n             //     await handleSearch(\"local\"); // Default to global search on enter\n             //   }\n             // }}\n-            placeholder={t('apiSearchDrawer.placeholder')\"Enter search query for API\"}\n+            placeholder={t('apiSearchDrawer.placeholder') || }\n             fullWidth\n             margin=\"normal\"\n           />\n \n"
                },
                {
                    "date": 1727249711825,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -122,9 +122,9 @@\n             //   if (e.key === \"Enter\" && !loadingLocal) {\n             //     await handleSearch(\"local\"); // Default to global search on enter\n             //   }\n             // }}\n-            placeholder={t('apiSearchDrawer.placeholder') || }\n+            placeholder={t('apiSearchDrawer.placeholder') || 'Enter search query for API'}\n             fullWidth\n             margin=\"normal\"\n           />\n \n"
                }
            ],
            "date": 1727243774068,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from \"react\";\nimport {\n  Box,\n  Button,\n  CircularProgress,\n  Drawer,\n  TextField,\n  Typography,\n  Card,\n  CardContent,\n  CardHeader,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  Paper,\n  IconButton,\n  Collapse,\n  Link,\n  Alert,\n} from \"@mui/material\";\nimport CloseIcon from \"@mui/icons-material/Close\";\nimport ExpandMoreIcon from \"@mui/icons-material/ExpandMore\";\nimport ExpandLessIcon from \"@mui/icons-material/ExpandLess\";\nimport { SearchResult } from \"../models/search-result\";\nimport { useTranslation } from 'react-i18next';\n\ninterface APISearchDrawerProps {\n  apiDrawerOpen: boolean;\n  toggleDrawer: (open: boolean) => () => void;\n  handleApiSearch: (\n    query: string,\n    searchType: \"local\" | \"global\"\n  ) => Promise<void>;\n  apiSearchResults: SearchResult | null;\n  localSearchEnabled: boolean;\n  globalSearchEnabled: boolean;\n  hasCovariates: boolean;\n  serverUp: boolean;\n}\n\nconst APISearchDrawer: React.FC<APISearchDrawerProps> = ({\n  apiDrawerOpen,\n  toggleDrawer,\n  handleApiSearch,\n  apiSearchResults,\n  localSearchEnabled,\n  globalSearchEnabled,\n  hasCovariates,\n  serverUp,\n}) => {\n  const [query, setQuery] = useState<string>(\"\");\n  const [loadingLocal, setLoadingLocal] = useState<boolean>(false);\n  const [loadingGlobal, setLoadingGlobal] = useState<boolean>(false);\n  const [expandedTables, setExpandedTables] = useState<{\n    [key: string]: boolean;\n  }>({});\n\n  useEffect(() => {\n    // Initialize the expandedTables state to false for all keys in context_data\n    if (apiSearchResults && apiSearchResults.context_data) {\n      const initialExpandedState: { [key: string]: boolean } = {};\n      Object.keys(apiSearchResults.context_data).forEach((key) => {\n        initialExpandedState[key] = true;\n      });\n      setExpandedTables(initialExpandedState);\n    }\n  }, [apiSearchResults]);\n\n  const handleSearch = async (searchType: \"local\" | \"global\") => {\n    if (searchType === \"local\") {\n      setLoadingLocal(true);\n    } else {\n      setLoadingGlobal(true);\n    }\n\n    try {\n      await handleApiSearch(query, searchType);\n    } finally {\n      if (searchType === \"local\") {\n        setLoadingLocal(false);\n      } else {\n        setLoadingGlobal(false);\n      }\n    }\n  };\n\n  const toggleTable = (key: string) => {\n    setExpandedTables((prevState) => ({\n      ...prevState,\n      [key]: !prevState[key],\n    }));\n  };\n\n  return (\n    <Drawer\n      anchor=\"left\"\n      open={apiDrawerOpen}\n      onClose={toggleDrawer(false)}\n      sx={{ zIndex: 1500 }}\n    >\n      <Box\n        sx={{ width: \"60vw\", padding: 2, paddingTop: 6, position: \"relative\" }}\n      >\n        {/* Close Button at the top-right corner */}\n        <IconButton\n          onClick={toggleDrawer(false)}\n          sx={{ position: \"absolute\", top: 8, right: 8 }}\n        >\n          <CloseIcon />\n        </IconButton>\n\n        {/* First Row: TextField */}\n        <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 2 }}>\n          <TextField\n            value={query}\n            onChange={(e) => setQuery(e.target.value)}\n            // onKeyDown={async (e) => {\n            //   if (e.key === \"Enter\" && !loadingLocal) {\n            //     await handleSearch(\"local\"); // Default to global search on enter\n            //   }\n            // }}\n            placeholder=\"Enter search query for API\"\n            fullWidth\n            margin=\"normal\"\n          />\n\n          {/* Second Row: Buttons */}\n          <Box sx={{ display: \"flex\", gap: 2 }}>\n            <Button\n              variant=\"contained\"\n              sx={{ flex: 1, whiteSpace: \"normal\", textAlign: \"center\" }}\n              onClick={() => handleSearch(\"local\")}\n              disabled={\n                !serverUp ||\n                !localSearchEnabled ||\n                loadingLocal ||\n                loadingGlobal\n              }\n            >\n              {loadingLocal ? <CircularProgress size={24} /> : \"Local Search\"}\n            </Button>\n            <Button\n              variant=\"contained\"\n              color=\"success\"\n              sx={{ flex: 1, whiteSpace: \"normal\", textAlign: \"center\" }}\n              onClick={() => handleSearch(\"global\")}\n              disabled={\n                !serverUp ||\n                !globalSearchEnabled ||\n                loadingLocal ||\n                loadingGlobal\n              }\n            >\n              {loadingGlobal ? <CircularProgress size={24} /> : \"Global Search\"}\n            </Button>\n          </Box>\n\n          {!serverUp && (\n            <Alert severity=\"error\" sx={{ mt: 1 }}>\n              Server is not running. Please start the server to use the API.\n              Follow the instructions at{\" \"}\n              <Link\n                href=\"https://github.com/noworneverev/graphrag-api\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                graphrag-api\n              </Link>\n              .\n            </Alert>\n          )}\n          {!localSearchEnabled && (\n            <Alert severity=\"warning\" sx={{ mt: 1 }}>\n              Please enable \"Include Text Unit\" and \"Include Communities\"\n              {hasCovariates && ', and \"Include Covariates\"'} to use Local\n              Search.\n            </Alert>\n          )}\n          {!globalSearchEnabled && (\n            <Alert severity=\"warning\" sx={{ mt: 1 }}>\n              Please enable \"Include Communities\" to use Global Search.\n            </Alert>\n          )}\n        </Box>\n\n        {apiSearchResults && (\n          <>\n            {/* Search Results Card */}\n            <Card sx={{ marginTop: 2 }}>\n              <CardHeader title=\"Search Results\" />\n              <CardContent>\n                <Typography variant=\"body1\" sx={{ whiteSpace: \"pre-wrap\" }}>\n                  {apiSearchResults.response}\n                </Typography>\n              </CardContent>\n            </Card>\n\n            {/* Metadata Card */}\n            <Card sx={{ marginTop: 2 }}>\n              <CardHeader title=\"Metadata\" />\n              <CardContent>\n                <Typography variant=\"body2\">\n                  <strong>Completion Time:</strong>{\" \"}\n                  {apiSearchResults.completion_time} ms\n                </Typography>\n                <Typography variant=\"body2\">\n                  <strong>LLM Calls:</strong> {apiSearchResults.llm_calls}\n                </Typography>\n                <Typography variant=\"body2\">\n                  <strong>Prompt Tokens:</strong>{\" \"}\n                  {apiSearchResults.prompt_tokens}\n                </Typography>\n              </CardContent>\n            </Card>\n\n            {/* Context Data Tables */}\n            {apiSearchResults &&\n              apiSearchResults.context_data &&\n              Object.entries(apiSearchResults.context_data).map(\n                ([key, data], index) => (\n                  <Card sx={{ marginTop: 2 }} key={index}>\n                    <CardHeader\n                      title={key.charAt(0).toUpperCase() + key.slice(1)}\n                      action={\n                        <IconButton onClick={() => toggleTable(key)}>\n                          {expandedTables[key] ? (\n                            <ExpandLessIcon />\n                          ) : (\n                            <ExpandMoreIcon />\n                          )}\n                        </IconButton>\n                      }\n                    />\n                    <Collapse\n                      in={expandedTables[key]}\n                      timeout=\"auto\"\n                      unmountOnExit\n                    >\n                      <CardContent>\n                        {Array.isArray(data) && data.length > 0 ? (\n                          <TableContainer component={Paper}>\n                            <Table size=\"small\">\n                              <TableHead>\n                                <TableRow>\n                                  {Object.keys(data[0]).map(\n                                    (columnName, idx) => (\n                                      <TableCell key={idx}>\n                                        {columnName.charAt(0).toUpperCase() +\n                                          columnName.slice(1)}\n                                      </TableCell>\n                                    )\n                                  )}\n                                </TableRow>\n                              </TableHead>\n                              <TableBody>\n                                {data.map((row, rowIndex) => (\n                                  <TableRow key={rowIndex}>\n                                    {Object.values(row).map(\n                                      (value, cellIndex) => (\n                                        <TableCell key={cellIndex}>\n                                          {typeof value === \"string\"\n                                            ? value\n                                            : JSON.stringify(value, null, 2)}\n                                        </TableCell>\n                                      )\n                                    )}\n                                  </TableRow>\n                                ))}\n                              </TableBody>\n                            </Table>\n                          </TableContainer>\n                        ) : (\n                          <Typography variant=\"body2\" color=\"textSecondary\">\n                            No data available\n                          </Typography>\n                        )}\n                      </CardContent>\n                    </Collapse>\n                  </Card>\n                )\n              )}\n          </>\n        )}\n      </Box>\n    </Drawer>\n  );\n};\n\nexport default APISearchDrawer;\n"
        }
    ]
}